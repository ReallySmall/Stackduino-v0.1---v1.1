<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Stackduino by ReallySmall</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Stackduino</h1>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/ReallySmall/Stackduino/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/ReallySmall/Stackduino/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/ReallySmall/Stackduino" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
<h3>About</h3>
<p>Stackduino is an open source motion controller which interfaces with a stepper motor, limit switches and a camera shutter. It's simple to put together using cheap and widely available components.</p> 
<p>Stackduino was developed within the Arduino environment, primarily with focus stacking in mind - hence the name. However, with some tweaks to the code, it could also be used for any other application which involves moving a camera and taking a picture - such as 3d scanning, time-lapse, panorama stitching etc...</p>
  <a href="http://www.flickr.com/photos/reallysmall/12253193595/" title="Stackduino v1.1 pcb by Really Small, on Flickr"><img src="http://farm6.staticflickr.com/5496/12253193595_44f5db900c_b.jpg"  style="border: 1px solid black;" width="588" height="785" alt="Stackduino v1.1 pcb"></a>       
<div style="background-color: white; padding: 5px; border: 1px solid grey; font-size: 80%; max-width: 575px;"><small>Stackduino v1 populated pcb, top and bottom views.</small></div>
<p></p>	
 <a href="http://www.flickr.com/photos/reallysmall/10761814804/" title="Stackduino v1.1 pcb by Really Small, on Flickr"><img src="http://farm3.staticflickr.com/2836/10761814804_6a7b592182_b.jpg"  style="border: 1px solid black;" width="588" height="1024" alt="Stackduino v1.1 pcb"></a>      
<div style="background-color: white; padding: 5px; border: 1px solid grey; font-size: 80%; max-width: 575px;"><small>Stackduino v1 pcb layout, top and bottom views.</small></div>
<p></p>		  
<h3>Focus Stacking</h3>
<p><a href="http://en.wikipedia.org/wiki/Focus_stacking">Focus stacking</a> is a technique commonly used in macro-photography which combines multiple images taken at different focus distances (often using some form of linear stage) to give a resulting image with a greater depth of field than any of the individual source images.</p>
<a href="http://www.flickr.com/photos/reallysmall/8925700250/" title="Dagger Fly by Really Small, on Flickr"><img style="border: 1px solid black;" src="http://farm4.staticflickr.com/3828/8925700250_7f0f9cd9f6_b.jpg" width="683" height="1024" alt="Dagger Fly"></a>
<div style="background-color: white; padding: 5px; border: 1px solid grey; font-size: 80%"><small>Example of a focus stacked image, made using Stackduino. Taken at 5x magnification, a composite of 150 incrementally focused images, 14 microns apart.</small></div>
<p></p>
<p>Focus stacking can be achieved manually by adjusting the linear stage to the next position, releasing the camera shutter and repeating. However, there are some drawbacks to stacking by hand:</p>
<ul>
<li>Adjusting the stage accurately by eye can be difficult and repeating that accuracy for every focus slice, even more so. Any slices which are too deep will create an out of focus band in the final image</li>
<li>Touching the equipment introduces vibration and small movements which can adversely affect the final image</li>
<li>Manual stacking accurately is time-consuming. If photographing a live subject the window of opportunity may be lost before the stack is complete</li>
</ul>
<p>Attaching a small stepper motor to the linear stage's actuator and controlling it electronically avoids these problems. Focus stacks become quicker, accurate and repeatable.</p>

<a href="http://www.flickr.com/photos/reallysmall/5649044078/" title="Automated Macro Focus Stacking Setup by Really Small, on Flickr"><img src="http://farm6.staticflickr.com/5109/5649044078_0ddf5f36c2_z.jpg" width="640" height="416" alt="Automated Macro Focus Stacking Setup"></a>
<div style="background-color: white; padding: 5px; border: 1px solid grey; font-size: 80%"><small>Example of a focus stacking setup with stepper motor (3) connected to linear stage (5) using a timing belt and pulleys (4). The junction box (6) connects the Stackduino controller to the stacker with a serial cable and breaks out the motor, limit switch and camera signals.</small></div>
<p></p>
<h3>Contents of the Repo</h3>

<p>The Stackduino GitHub repository includes the gerber files required to produce a pcb, a parts list and the code required to run the controller.</p>

<h3>Current features:</h3>
<ul>
<li>Manual forward and backward control of the stepper motor to set up the stack</li>
<li>Set step size</li>
<li>Set number of steps</li>
<li>Set pause time between steps</li>
<li>Set number of images to take per step (for exposure bracketing if supported by camera)</li>
<li>Toggle whether stage returns to start position at end of stack</li>
<li>Select unit of measurement for steps: microns, mm or cm</li>
<li>Adjust speed of stepper motor</li>
<li>Disable Easydriver when not stepping: runs a lot cooler and uses less energy. For best results the stacker mechanics should be able to hold exact position without the aid of motor torque</li>
</ul>

<h3>Notes on code</h3>
<ul>
<li>The code is developed in the Arduino IDE</li>
<li>The "DigitalToggle" library should be imported into your arduino install. It's required for the sketch to compile</li>
</ul>

<h3>Notes on hardware</h3>
<h4>General</h4>
<ul>
<li>The pcb was designed in <a href="http://fritzing.org/">Fritzing</a></li>
<li>The MCU is an ATMega 328 chip, flashed with the Arduino Uno bootloader. The board provides a pinout for programming the chip with a generic FT232RL USB > Serial Adapter</li>
<li>To protect the camera, optocouplers electrically separate it from the controller</li>
<li>Stepper driving is looked after by an <a href="http://www.schmalzhaus.com/EasyDriver/">Easydriver</a> board attached to the underside of the main pcb</li>
<li>It's a pretty straightforward circuit, but usual disclaimers apply - build at your own risk</li>
</ul>
<h4>Power</h4>
<ul>
<li>Power requirements are largely dictated by the stepper driver and motor - aim for a dc adapter capable of supplying at least 1A at 12v</li>
<li>Battery/ wall adapter power selection is done with a simple diode OR system. The supply with the highest voltage is the one that gets used, so to work as expected the battery voltage should be a little lower than the dc adapter's</li>
</ul>
<h3>Next steps</h3>
<p>Tinkering has started on Stackduino v2. This will be largely based on SMD components and build on v1 with various additions and improvements:</p>
<ul>
<li>smaller</li>
<li>more efficient use of battery power</li>
<li>built in micro-usb port for programming/ tethered use</li>
</ul>

<h3>Acknowledgements</h3>
<p>Thanks in particular to Flickr users bert01980 and nsomniius for bug reports and input on development. Various prototyping images and discussion are available on <a href="http://www.flickr.com/photos/reallysmall/sets/72157632341602394/with/10761814804/">Flickr</a>.</p>
        </section>

        <footer>
          Stackduino is maintained by <a href="https://github.com/ReallySmall">ReallySmall</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-45814549-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>